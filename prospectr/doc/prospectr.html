<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Antoine Stevens and Leonardo Ramirez-Lopez [ramirez.lopez.leo@gmail.com]" />

<meta name="date" content="2021-11-26" />

<title>An introduction to the prospectr package</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">An introduction to the <code>prospectr</code> package</h1>
<h4 class="author">Antoine Stevens and Leonardo Ramirez-Lopez [<a href="mailto:ramirez.lopez.leo@gmail.com" class="email">ramirez.lopez.leo@gmail.com</a>]</h4>
<h4 class="date">2021-11-26</h4>


<div id="TOC">
<ul>
<li><a href="#preamble"><span class="toc-section-number">1</span> Preamble</a></li>
<li><a href="#introduction"><span class="toc-section-number">2</span> Introduction</a></li>
<li><a href="#citing-the-package"><span class="toc-section-number">3</span> Citing the package</a></li>
<li><a href="#signal-processing"><span class="toc-section-number">4</span> Signal Processing</a>
<ul>
<li><a href="#noise-removal"><span class="toc-section-number">4.1</span> Noise removal</a></li>
<li><a href="#moving-average-or-runnnig-mean"><span class="toc-section-number">4.2</span> Moving average or runnnig mean</a></li>
<li><a href="#savitzky-golay-filtering"><span class="toc-section-number">4.3</span> Savitzky-Golay filtering</a></li>
<li><a href="#derivatives"><span class="toc-section-number">4.4</span> Derivatives</a></li>
<li><a href="#scatter-and-baseline-corrections"><span class="toc-section-number">4.5</span> Scatter and baseline corrections</a></li>
<li><a href="#centering-and-scaling"><span class="toc-section-number">4.6</span> Centering and scaling</a></li>
</ul></li>
<li><a href="#resampling"><span class="toc-section-number">5</span> Resampling</a></li>
<li><a href="#other-transformations"><span class="toc-section-number">6</span> Other transformations</a>
<ul>
<li><a href="#continuum-removal"><span class="toc-section-number">6.1</span> Continuum removal</a></li>
</ul></li>
<li><a href="#calibration-sampling-algorithms"><span class="toc-section-number">7</span> Calibration sampling algorithms</a>
<ul>
<li><a href="#k-means-sampling-naes"><span class="toc-section-number">7.1</span> <span class="math inline">\(k\)</span>-means sampling (<code>naes</code>)</a></li>
<li><a href="#kennard-stone-sampling-kenstone"><span class="toc-section-number">7.2</span> Kennard-Stone sampling (<code>kenStone</code>)</a></li>
<li><a href="#duplex-duplex"><span class="toc-section-number">7.3</span> DUPLEX (<code>duplex</code>)</a></li>
<li><a href="#select-algorithm-shenkwest"><span class="toc-section-number">7.4</span> SELECT algorithm (<code>shenkWest</code>)</a></li>
<li><a href="#puchwein-algorithm-puchwein"><span class="toc-section-number">7.5</span> Puchwein algorithm (<code>puchwein</code>)</a></li>
<li><a href="#honigs-honigs"><span class="toc-section-number">7.6</span> Honigs (<code>honigs</code>)</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p><img src="data:image/jpeg;base64,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8F6c3Yy/CJpc6v8AyIE9GS6j+WrKVQmXq86aeW//2gAMAwEAAgADAAAAEJJJJJJJJJIKrJJJJJJJJJJJJJJJJJJJGGqrJJJJJJJJJJJJJJJJJI1BWVPJJJJJJJJJJJJJJJBSkraEr3JJJJJJJIBJJJJJDZrbbbPthJJJJJJJJJJJIylLahLbaM/pJJJJJJJJJJNl7bbg1bbR1IpJJJJJJJIMNZbbQjdbbbYeWJJJJJJJHBpbbbeilbbbbRqFJJJJJNNFbbbbev8AW22220rRySSSIzS22227XAK222222LISSGUu22222mdM2222222r1aRIO222222qj8e2222222w+Be2222221T2/e22222222gZe2222223RJJu22222222i7O2222228eiPs22222222pZO222222sPaM4W2222222gZe2222227URZTW2222222u4e2222202P26J22222222j5e222229edW3k22222222u6m222217VW201G2222222hfe2222x+bW21G22222222oZGSe+IDhC222vS2222222i5NVU1hqm22223m2222222q5UA59nny22222K22rYE07W6lAJuS2222228v2pdMjTJ15W2222222222oE2qRPpbnq6m22222222221OUKlcUON1au22222222223iPMQ20Dqpbe22222222223hIxa2222i4S22222222220IiOK2222v5e2222222222300l22222i5e22222222223rVO1W222oZe22222222222iA6rG222i5e21YXEUjgHkW4Os9G6XWtZe21PAKhAF9Nb3cDyaiBWi/IW1axWsGJXnpA8ewElW28YAK1LreltcYXKHnH/wC99rNoimbQLgtuqswFr9r1rAE5FkkhCAttttttItttttttatkkkkFzEttttttttttttKsEkkkkklu9ttttttttttas8kkkkkkk8klttttttttlkskkkkkkkkkIcttttttthQskkkkkkkkkkg2qFttttszEkkkkkkkkkkkknVrtttq67kkkkkkkkkkkkkkhCKttC2kkkkkkkkkkkkkkkkG+0jMkkkkkkkkkkkkkkkkkkhp1ckkkkkkkkkkkkkkkkkkkTskkkkkkkkkk/8QAKhEAAQMCAwgDAQEBAAAAAAAAAQAR8CExQVFh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" width="20%" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px; display: inline-block; float: right;margin: 50px 0px 0px 20px;" style="display: block; margin: auto 0 auto auto;" /></p>
<div id="preamble" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Preamble</h1>
<p><code>prospectr</code> is becoming more and more used in spectroscopic applications, which
is evidenced by the number of scientific publications citing the package. This
package is very useful for singal processing and chemometrics in general as it
provides various utilities for pre–processing and sample selection of spectral
data. While similar functions are available in other packages, like <a href="https://CRAN.R-project.org/package=signal"><code>signal</code></a>, the functions in this
package works indifferently for <code>data.frame</code>, <code>matrix</code> and <code>vector</code> inputs.
Besides, several functions are optimized for speed and use C++ code through the <a href="https://CRAN.R-project.org/package=Rcpp"><code>Rcpp</code></a> and <a href="https://CRAN.R-project.org/package=RcppArmadillo"><code>RcppArmadillo</code></a> packages.</p>
</div>
<div id="introduction" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Introduction</h1>
<p>Several spectroscopic techniques such as Near-Infrared (NIR) spectroscopy are
high–troughput, non–destructive and cheap sensing methods that has a range of
applications in agricultural, medical, food and environmental science. A number
of <code>R</code> packages of interest for the spectroscopist is already available for
processing and analysis of spectroscopic data.</p>
<p>Since the publication of the
<a href="https://www.jstatsoft.org/issue/view/v018">special special Volume in Spectroscopy and Chemometrics in R</a> <span class="citation">(<a href="#ref-mullen2007" role="doc-biblioref">Mullen and Stokkum 2007</a>)</span> many spectroscopy-related packages have been released. Most of
these packages can be found at the following CRAN task views:</p>
<ul>
<li><p><a href="https://CRAN.R-project.org/view=Multivariate">Multivariate Statistics</a></p></li>
<li><p><a href="https://CRAN.R-project.org/view=MachineLearning">Machine Learning &amp; Statistical Learning</a></p></li>
<li><p><a href="https://CRAN.R-project.org/view=ChemPhys">Chemometrics and Computational Physics</a></p></li>
</ul>
<p>In addition, <a href="https://github.com/bryanhanson?tab=followers">Bryan Hanson</a>
provides a list of Free Open Source Software (FOSS) dedictaed to Spectroscopic
applications in general
(see <a href="https://bryanhanson.github.io/FOSS4Spectroscopy/">https://bryanhanson.github.io/FOSS4Spectroscopy/</a>).</p>
</div>
<div id="citing-the-package" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Citing the package</h1>
<p><code>prospectr</code> is becoming more and more used in spectroscopic applications, which
is evidenced by the number of scientific publications citing the package.
This package is very useful for singal processing and chemometrics in general as
provides various utilities for pre–processing and sample selection
of spectral data. Please use the following citation. Simply type and you will
get the info you need:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="at">package =</span> <span class="st">&quot;prospectr&quot;</span>)</span></code></pre></div>
<pre><code>## 
## To cite package &#39;prospectr&#39; in publications use:
## 
##   Antoine Stevens and Leornardo Ramirez-Lopez (2021). An introduction
##   to the prospectr package. R package Vignette R package version 0.2.2.
## 
## A BibTeX entry for LaTeX users is
## 
##   @Manual{,
##     title = {An introduction to the prospectr package},
##     author = {Antoine Stevens and Leornardo Ramirez-Lopez},
##     publication = {R package Vignette},
##     year = {2021},
##     note = {R package version 0.2.2},
##   }</code></pre>
</div>
<div id="signal-processing" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Signal Processing</h1>
<p>The aim of spectral pre-treatment is to improve signal quality before modeling
as well as remove physical information from the spectra. Applying a
pre-treatment can increase the repeatability/reproducibility of the method,
model robustness and accuracy, although there are no guarantees this will
actually work. The pre-processing functions that are currently available in the
package are listed in Table 1.</p>
<p>Table 1. List of pre-processing functions</p>
<table>
<thead>
<tr class="header">
<th>Function Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>movav</code></td>
<td>simple moving (or running) average filter</td>
</tr>
<tr class="even">
<td><code>savitzkyGolay</code></td>
<td>Savitzky–Golay smoothing and derivative</td>
</tr>
<tr class="odd">
<td><code>gapDer</code></td>
<td>gap–segment derivative</td>
</tr>
<tr class="even">
<td><code>baseline</code></td>
<td>baseline removal (similar to <code>continuumRemoval</code>)</td>
</tr>
<tr class="odd">
<td><code>continuumRemoval</code></td>
<td>computes continuum–removed values</td>
</tr>
<tr class="even">
<td><code>detrend</code></td>
<td>detrend normalization</td>
</tr>
<tr class="odd">
<td><code>standardNormalVariate</code></td>
<td>Standard Normal Variate (SNV) transformation</td>
</tr>
<tr class="even">
<td><code>msc</code></td>
<td>Multiplicative Scatter Correction</td>
</tr>
<tr class="odd">
<td><code>binning</code></td>
<td>average a signal in column bins</td>
</tr>
<tr class="even">
<td><code>resample</code></td>
<td>resample a signal to new band positions</td>
</tr>
<tr class="odd">
<td><code>resample2</code></td>
<td>resample a signal using new FWHM values</td>
</tr>
<tr class="even">
<td><code>blockScale</code></td>
<td>block scaling</td>
</tr>
<tr class="odd">
<td><code>blockNorm</code></td>
<td>sum of squares block weighting</td>
</tr>
</tbody>
</table>
<p>We show below how they can be used, using the Near-Infrared (NIR) dataset
(NIRsoil) included in the package <span class="citation">(<a href="#ref-fernandez2008" role="doc-biblioref">Fernandez-Pierna and Dardenne 2008</a>)</span>. Observations should be
arranged row-wise.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prospectr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(NIRsoil)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># NIRsoil is a data.frame with 825 obs and 5 variables: Nt (Total Nitrogen),</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ciso (Carbon), CEC (Cation Exchange Capacity), train (vector of 0,1</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># indicating training (1) and validation (0) samples), spc (spectral matrix)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(NIRsoil)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    825 obs. of  5 variables:
##  $ Nt   : num  0.3 0.69 0.71 0.85 NA ...
##  $ Ciso : num  0.22 NA NA NA 0.9 NA NA 0.6 NA 1.28 ...
##  $ CEC  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ train: num  1 1 1 1 1 1 1 1 1 1 ...
##  $ spc  : num [1:825, 1:700] 0.339 0.308 0.328 0.364 0.237 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:825] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:700] &quot;1100&quot; &quot;1102&quot; &quot;1104&quot; &quot;1106&quot; ...</code></pre>
<div id="noise-removal" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Noise removal</h2>
<p>Noise represents random fluctuations around the signal that can originate from
the instrument or environmental laboratory conditions. The simplest solution to
remove noise is to perform <span class="math inline">\(n\)</span> repetition of the measurements, and the average
individual spectra. The noise will decrease with a factor <span class="math inline">\(\sqrt{n}\)</span>. When this
is not possible, or if residual noise is still present in the data, the noise
can be removed mathematically.</p>
</div>
<div id="moving-average-or-runnnig-mean" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Moving average or runnnig mean</h2>
<p>A moving average filter is a column-wise operation which average contiguous
wavelengths within a given window size.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add some noise</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>noisy <span class="ot">&lt;-</span> NIRsoil<span class="sc">$</span>spc <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(NIRsoil<span class="sc">$</span>spc), <span class="dv">0</span>, <span class="fl">0.001</span>) </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the first spectrum</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> noisy[<span class="dv">1</span>, ],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Wavelength&quot;</span>, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>) </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">movav</span>(<span class="at">X =</span> noisy, <span class="at">w =</span> <span class="dv">11</span>) <span class="co"># window size of 11 bands</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the 5 first and last bands are lost in the process</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(X)), <span class="at">y =</span> X[<span class="dv">1</span>,], <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;moving average&quot;</span>), </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:movin"></span>
<img src="data:image/png;base64,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" alt="Effect of a moving average with window size of 11 bands on a raw spectrum" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 4.1: Effect of a moving average with window size of 11 bands on a raw spectrum
</p>
</div>
</div>
<div id="savitzky-golay-filtering" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Savitzky-Golay filtering</h2>
<p>Savitzky-Golay filtering <span class="citation">(<a href="#ref-savitzky1964" role="doc-biblioref">Savitzky and Golay 1964</a>)</span> is a very common preprocessing
technique. It fits a local polynomial regression on the signal and requires
<strong>equidistant</strong> bandwidth. Mathematically, it operates simply as a weighted sum
of neighbouring values:</p>
<p><span class="math display">\[ x_j\ast = \frac{1}{N}\sum_{h=-k}^{k}{c_hx_{j+h}}\]</span></p>
<p>where <span class="math inline">\(x_j\ast\)</span> is the new value, <span class="math inline">\(N\)</span> is a normalizing coefficient, <span class="math inline">\(k\)</span> is the
number of neighbour values at each side of <span class="math inline">\(j\)</span> and <span class="math inline">\(c_h\)</span> are pre-computed
coefficients, that depends on the chosen polynomial order and degree (smoothing,
first and second derivative).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p = polynomial order w = window size (must be odd) m = m-th derivative (0 =</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># smoothing) The function accepts vectors, data.frames or matrices.  For a</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix input, observations should be arranged row-wise</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>sgvec <span class="ot">&lt;-</span> <span class="fu">savitzkyGolay</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc[<span class="dv">1</span>, ], <span class="at">p =</span> <span class="dv">3</span>, <span class="at">w =</span> <span class="dv">11</span>, <span class="at">m =</span> <span class="dv">0</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sg <span class="ot">&lt;-</span> <span class="fu">savitzkyGolay</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">w =</span> <span class="dv">11</span>, <span class="at">m =</span> <span class="dv">0</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># note that bands at the edges of the spectral matrix are lost !</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(NIRsoil<span class="sc">$</span>spc)</span></code></pre></div>
<pre><code>## [1] 825 700</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sg)</span></code></pre></div>
<pre><code>## [1] 825 690</code></pre>
</div>
<div id="derivatives" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Derivatives</h2>
<p>Taking (numerical) derivatives of the spectra can remove both additive and
multiplicative effects in the spectra and have other consequences as well
(Table 2).</p>
<p>Table 2. Pro’s and con’s of using derivative spectra.</p>
<table>
<colgroup>
<col width="42%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th>Advantage</th>
<th>Drawback</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Reduce of baseline offset</td>
<td>Risk of overfitting the calibration model</td>
</tr>
<tr class="even">
<td>Can resolve absorption overlapping</td>
<td>Increase noise, smoothing required</td>
</tr>
<tr class="odd">
<td>Compensates for instrumental drift</td>
<td>Increase uncertainty in model coefficients</td>
</tr>
<tr class="even">
<td>Enhances small spectral absorptions</td>
<td>Complicate spectral interpretation</td>
</tr>
<tr class="odd">
<td>Often increase predictive accuracy</td>
<td>Remove the baseline !</td>
</tr>
<tr class="even">
<td>for complex datasets</td>
<td></td>
</tr>
</tbody>
</table>
<p>First and second derivatives of a spectrum can be computed with the finite
difference method (difference between to subsequent data points), provided
that the band width is constant:</p>
<p><span class="math display">\[ x_i&#39; = x_i - x_{i-1}\]</span></p>
<p><span class="math display">\[ x_i&#39;&#39; = x_{i-1} - 2 \cdot x_i + x_{i+1}\]</span></p>
<p>In R, this can be simply achieved with the <code>diff</code> function in <code>base</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X = wavelength</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Y = spectral matrix</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n = order</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">diff</span>(<span class="fu">t</span>(NIRsoil<span class="sc">$</span>spc), <span class="at">differences =</span> <span class="dv">1</span>)) <span class="co"># first derivative</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">diff</span>(<span class="fu">t</span>(NIRsoil<span class="sc">$</span>spc), <span class="at">differences =</span> <span class="dv">2</span>)) <span class="co"># second derivative</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(d1)), </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     d1[<span class="dv">1</span>,], </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">1.5</span>, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Wavelength&quot;</span>, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(d2)), d2[<span class="dv">1</span>,], <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;1st der&quot;</span>, <span class="st">&quot;2nd der&quot;</span>), </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:d1"></span>
<img src="data:image/png;base64,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" alt="Effect of first derivative and second derivative" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 4.2: Effect of first derivative and second derivative
</p>
</div>
<p>One can see that derivatives tend to increase noise. One can use gap derivatives
or the Savitzky-Golay algorithm to solve this. The gap derivative is computed
simply as:</p>
<p><span class="math display">\[ x_i&#39; = x_{i+k} - x_{i-k}\]</span></p>
<p><span class="math display">\[ x_i&#39;&#39; = x_{i-k} - 2 \cdot x_i + x_{i+k}\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the gap size. Again, this can be easily achieved in R using the
<code>lag</code> argument of the <code>diff</code> function</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first derivative with a gap of 10 bands</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>gd1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">diff</span>(<span class="fu">t</span>(NIRsoil<span class="sc">$</span>spc), <span class="at">differences =</span> <span class="dv">1</span>, <span class="at">lag =</span> <span class="dv">10</span>)) </span></code></pre></div>
<p>For more flexibility and control over the degree of smoothing, one could however
use the Savitzky-Golay (<code>savitzkyGolay</code>) and Gap-segment derivative (<code>gapDer</code>)
algorithms. The Gap-segment algorithms performs first a smoothing under a given
segment size, followed by a derivative of a given order under a given gap size.
Here is an exemple of the use of the <code>gapDer</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m = order of the derivative</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># w = window size ( = {2 * gap size} + 1)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># s = segment size</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># first derivative with a gap of 10 bands</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>gsd1 <span class="ot">&lt;-</span> <span class="fu">gapDer</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">w =</span> <span class="dv">11</span>, <span class="at">s =</span> <span class="dv">10</span>) </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(d1)), </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>     d1[<span class="dv">1</span>,], </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">1.5</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Wavelength&quot;</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(gsd1)), gsd1[<span class="dv">1</span>,], <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;1st der&quot;</span>,<span class="st">&quot;gap-segment 1st der&quot;</span>), </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:gapseg"></span>
<img src="data:image/png;base64,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" alt="Effect of 1st-order gap-segment derivative " style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 4.3: Effect of 1st-order gap-segment derivative
</p>
</div>
</div>
<div id="scatter-and-baseline-corrections" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Scatter and baseline corrections</h2>
<p>Undesired spectral variations due to light <em>scatter</em> effects and variations in
effective <em>path length</em> can be removed using scatter corrections.</p>
<div id="standard-normal-variate-snv" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Standard Normal Variate (SNV)</h3>
<p><em>Standard Normal Variate</em> (SNV) is another simple way for normalizing spectra
that intends to correct for light <em>scatter</em>. It operates row-wise:</p>
<p><span class="math display">\[ SNV_i = \frac{x_i - \bar{x_i}}{s_i}\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>snv <span class="ot">&lt;-</span> <span class="fu">standardNormalVariate</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc)</span></code></pre></div>
<p>According to <span class="citation"><a href="#ref-fearn2008" role="doc-biblioref">Fearn</a> (<a href="#ref-fearn2008" role="doc-biblioref">2008</a>)</span>, it is better to perform SNV transformation after
filtering (by e.g. Savitzky-Golay) than the reverse.</p>
</div>
<div id="multiplicative-scatter-correction-msc" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Multiplicative scatter correction (MSC)</h3>
<p>Along with SNV, MSC <span class="citation">(<a href="#ref-geladi1985linearization" role="doc-biblioref">Geladi, MacDougall, and Martens 1985</a>)</span> this is one of the most widely
used pre-processing techniques in NIR spectroscopy <span class="citation">(<a href="#ref-rinnan2009review" role="doc-biblioref">Rinnan, Van Den Berg, and Engelsen 2009</a>)</span>. This is
a normalization method that attempts to account for additive and multiplicative
effects by aligning each spectrum (<span class="math inline">\(x_i\)</span>) with an ideal reference one (<span class="math inline">\(x_r\)</span>) as
follows:
<span class="math display">\[x_i = m_i x_r + a_i\]</span>
<span class="math display">\[MSC(x_i) = \frac{a_i - x_i}{m_i}\]</span>
where <span class="math inline">\(a_i\)</span> and <span class="math inline">\(m_i\)</span> are the additive and multiplicative terms respectively.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X = input spectral matrix</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>msc_spc <span class="ot">&lt;-</span> <span class="fu">msc</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">reference_spc =</span> <span class="fu">colMeans</span>(NIRsoil<span class="sc">$</span>spc))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)), </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>     NIRsoil<span class="sc">$</span>spc[<span class="dv">1</span>,], </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Wavelength, nm&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)), </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>      msc_spc[<span class="dv">1</span>,], </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;MSC signal&quot;</span>), </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:msc"></span>
<img src="data:image/png;base64,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" alt="Effect of MSC on raw spectra" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 4.4: Effect of MSC on raw spectra
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Since the MSC-corrected is based on a reference spectrum, it is necessary to
save this spectrum in order to apply the same type of processing to new spectra
later on. The following code shows how this can be done in <code>prospectr</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a reference set of spectra</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Xr <span class="ot">&lt;-</span> NIRsoil<span class="sc">$</span>spc[NIRsoil<span class="sc">$</span>train <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># an &quot;unseen&quot; set of spectra</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Xu <span class="ot">&lt;-</span> NIRsoil<span class="sc">$</span>spc[NIRsoil<span class="sc">$</span>train <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># apply msc to Xr</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>Xr_msc <span class="ot">&lt;-</span> <span class="fu">msc</span>(Xr)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the same msc to Xu</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Xr_msc,<span class="st">&quot;Reference spectrum&quot;</span>) <span class="co"># use this info from the previous object</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>Xu_msc <span class="ot">&lt;-</span> <span class="fu">msc</span>(Xu, <span class="at">reference_spc =</span> <span class="fu">attr</span>(Xr_msc, <span class="st">&quot;Reference spectrum&quot;</span>))</span></code></pre></div>
</div>
<div id="snv-detrend" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> SNV-Detrend</h3>
<p>The <em>SNV-Detrend</em> <span class="citation">(<a href="#ref-barnes1989" role="doc-biblioref">Barnes, Dhanoa, and Lister 1989</a>)</span> further accounts for wavelength-dependent
scattering effects (variation in curvilinearity between the spectra). After a
<em>SNV</em> transformation, a 2<span class="math inline">\(^{nd}\)</span>-order polynomial is fit to the spectrum and
subtracted from it.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X = input spectral matrix</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># wav = band centers</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">detrend</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">wav =</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)), </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>     NIRsoil<span class="sc">$</span>spc[<span class="dv">1</span>,], </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Wavelength&quot;</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dt[<span class="dv">1</span>,], </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">1.5</span>, </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;detrend signal&quot;</span>), </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:detrend"></span>
<img src="data:image/png;base64,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" alt="Effect of SNV-Detrend on raw spectra" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 4.5: Effect of SNV-Detrend on raw spectra
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="baseline-removal" class="section level3" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Baseline removal</h3>
<p>This method estimates the baseline of a given spectrum and subtract it from the
original spectrum. For this, the <code>baseline</code> function comprises three basic steps:</p>
<ol style="list-style-type: decimal">
<li><p>The convex hull points of each spectrum are identified using the
<code>grDevices::chull</code> function.</p></li>
<li><p>To obtain the baseline of each spectrum, the convex hull points are linearly
interpolated to the same frequencies of the original spectra.</p></li>
<li><p>The baseline of each spectrum is subtracted from the original input spectrum.</p></li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(NIRsoil)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>wav <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of the 3 first absorbance spectra</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(wav,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">t</span>(NIRsoil<span class="sc">$</span>spc[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Wavelength /nm&quot;</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">baseline</span>(NIRsoil<span class="sc">$</span>spc, wav)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(wav, <span class="fu">t</span>(bs[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>fitted_baselines <span class="ot">&lt;-</span> <span class="fu">attr</span>(bs, <span class="st">&quot;baselines&quot;</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(wav, <span class="fu">t</span>(fitted_baselines[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:baselined"></span>
<img src="data:image/png;base64,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" alt="Absorbance spectra, baseline spectra and baseline corrected spectra" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 4.6: Absorbance spectra, baseline spectra and baseline corrected spectra
</p>
</div>
</div>
</div>
<div id="centering-and-scaling" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Centering and scaling</h2>
<p>Centering and scaling tranforms a given matrix to a matrix with columns with
zero mean (<em>centering</em>), unit variance (<em>scaling</em>) or both (<em>auto-scaling</em>):</p>
<p><span class="math display">\[ Xc_{ij} = X_{ij}  - \bar{X}_{j} \]</span></p>
<p><span class="math display">\[ Xs_{ij} = \frac{X_{ij}  - \bar{X}_{j}}{s_{j}} \]</span></p>
<p>where <span class="math inline">\(Xc\)</span> and <span class="math inline">\(Xs\)</span> are the mean centered and auto-scaled matrices, <span class="math inline">\(X\)</span> is the
input matrix, <span class="math inline">\(\bar{X}_{j}\)</span> and <span class="math inline">\(s_{j}\)</span> are the mean and standard deviation of
variable <span class="math inline">\(j\)</span>.</p>
<p>In R, these operations are simply obtained with the <code>scale</code> function. Other
types of scaling can be considered. Spectroscopic models can often be improved
by using ancillary data (e.g. temperature, …) <span class="citation">(<a href="#ref-fearn2010" role="doc-biblioref">Fearn 2010</a>)</span>. Due to the nature
of spectral data (multivariate), other data would have great chance to be
dominated by the spectral matrix and have no chance to contribute significantly
to the model due to purely numerical reasons <span class="citation">(<a href="#ref-eriksson2006" role="doc-biblioref">Eriksson et al. 2006</a>)</span>. One can use
<em>block scaling</em> to overcome this limitation. It basically uses different weights
for different block of variables. With <em>soft block scaling</em>, each block is
scaled (ie each column divided by a factor) such that the sum of their variance
is equal to the square root of the number of variables in the block. With
<em>hard block scaling</em>, each block is scaled such that the sum of their variance
is equal to 1.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X = spectral matrix type = &#39;soft&#39; or &#39;hard&#39; The ouptut is a list with the</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scaled matrix (Xscaled) and the divisor (f)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">blockScale</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">type =</span> <span class="st">&quot;hard&quot;</span>)<span class="sc">$</span>Xscaled</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">apply</span>(bs, <span class="dv">2</span>, var))  <span class="co"># this works!</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>he problem with <em>block scaling</em> is that it down-scale all the block variables
to the same variance. Since sometimes this is not advised, one can alternatively
use <em>sum of squares block weighting</em> . The spectral matrix is multiplied by a
factor to achieve a pre-determined sum of square:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X = spectral matrix targetnorm = desired norm for X</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>bn <span class="ot">&lt;-</span> <span class="fu">blockNorm</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">targetnorm =</span> <span class="dv">1</span>)<span class="sc">$</span>Xscaled</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bn<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># this works!</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
</div>
<div id="resampling" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Resampling</h1>
<p>To match the response of one instrument with another, a signal can be resampled
to new band positions by simple interpolation (<code>resample</code>) or using full width
half maximum (FWHM) values (<code>resample2</code>).</p>
</div>
<div id="other-transformations" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Other transformations</h1>
<div id="continuum-removal" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Continuum removal</h2>
<p>The continuum removal technique was introduced by <span class="citation"><a href="#ref-clark1984" role="doc-biblioref">Clark and Roush</a> (<a href="#ref-clark1984" role="doc-biblioref">1984</a>)</span> as an effective
method to highlight absorption features of minerals. It can be viewed as an
albedo normalization technique. This technique is based on the computation
of the continuum (or envelope) of a given spectrum. It is very similar to
<code>baseline</code>, however it differs from it in the third step, in which instead of
a baseline subtraction it divides the original spectrum by its continuum as follows:</p>
<p><span class="math display">\[\phi_{i} = \frac{x_{i}}{c_{i}};  i=\left \{ 1,..., p\right\}\]</span></p>
<p>where <span class="math inline">\(x_{i}\)</span> and <span class="math inline">\(c_{i}\)</span> are the original and the continuum reflectance (or absorbance)
values respectively at the <span class="math inline">\(i\)</span>^th wavelength of a set of <span class="math inline">\(p\)</span> wavelengths, and
<span class="math inline">\(\phi_{i}\)</span> is the final reflectance (or absorbance) value after continuum
removal.</p>
<p>The <code>continuumRemoval</code> function allows to compute the continuum-removed values
of either reflectance or absorbance spectra.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># type of data: &#39;R&#39; for reflectance (default), &#39;A&#39; for absorbance</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">continuumRemoval</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">type =</span> <span class="st">&quot;A&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of the 10 first abs spectra</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">t</span>(NIRsoil<span class="sc">$</span>spc[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">6</span>),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Wavelength /nm&quot;</span>, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Absorbance&quot;</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)), <span class="at">lty =</span> <span class="dv">1</span>, <span class="fu">t</span>(cr[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:cr"></span>
<img src="data:image/png;base64,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" alt="Absorbance and continuum-removed absorbance spectra" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 6.1: Absorbance and continuum-removed absorbance spectra
</p>
</div>
</div>
</div>
<div id="calibration-sampling-algorithms" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Calibration sampling algorithms</h1>
<p>Calibration models are usually developed on a <em>representative</em> portion of the
data (training set) and validated on the remaining set of samples
(test/validation set). There are several solutions for selecting samples, e.g.:</p>
<ul>
<li>random selection (see e.g. <code>sample</code> function in <code>base</code>)</li>
<li>stratified random sampling on percentiles of the response <span class="math inline">\(y\)</span></li>
<li>use the spectral data.</li>
</ul>
<p>For selecting representative samples, the <code>prospect</code> package provides functions
that use the third solution. The following functions are available:</p>
<ul>
<li><p><code>naes</code>: k-means Sampling <span class="citation">(<a href="#ref-naes2002" role="doc-biblioref">Naes et al. 2002</a>)</span></p></li>
<li><p><code>kenStone</code>: Kennard-Stone Sampling <em>a.k.a.</em> CADEX Sampling <span class="citation">(<a href="#ref-kennard1969" role="doc-biblioref">Kennard and Stone 1969</a>)</span></p></li>
<li><p><code>duplex</code>: Duplex Sampling <span class="citation">(<a href="#ref-snee1977" role="doc-biblioref">Snee 1977</a>)</span></p></li>
<li><p><code>puchwein</code>: Factor Analysis Sampling <span class="citation">(<a href="#ref-puchwein1988" role="doc-biblioref">Puchwein 1988</a>)</span></p></li>
<li><p><code>shenkWest</code>: SELECT Sampling <span class="citation">(<a href="#ref-shenk1991" role="doc-biblioref">Shenk and Westerhaus 1991</a>)</span></p></li>
<li><p><code>honigs</code>: Honigs Sampling <span class="citation">(<a href="#ref-honigs1985" role="doc-biblioref">Honigs et al. 1985</a>)</span></p></li>
</ul>
<div id="k-means-sampling-naes" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> <span class="math inline">\(k\)</span>-means sampling (<code>naes</code>)</h2>
<p>The <span class="math inline">\(k\)</span>-means sampling simply uses <span class="math inline">\(k\)</span>-means clustering algorithm. To sample a
subset of <span class="math inline">\(n\)</span> samples <span class="math inline">\(X_{tr} = \left \{ {x_{tr}}_{j} \right \}_{j=1}^{n}\)</span>,
from a given set of <span class="math inline">\(N\)</span> samples <span class="math inline">\(X = \left \{ x_i \right \}_{i=1}^{N}\)</span> (note
that <span class="math inline">\(N&gt;n\)</span>) the algorithm works as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Perform a <span class="math inline">\(k\)</span>-means clustering of <span class="math inline">\(X\)</span> using <span class="math inline">\(n\)</span> clusters.</p></li>
<li><p>Extract the <span class="math inline">\(n\)</span> centroids (<span class="math inline">\(c\)</span>, or prototypes). This can be also the sample
that is the farthest away from the centre of the data, or a random selection.
See the <code>method</code> argument in <code>naes</code></p></li>
<li><p>Calculate the distance of each sample to each <span class="math inline">\(c\)</span>.</p></li>
<li><p>For each <span class="math inline">\(c\)</span> allocate in <span class="math inline">\(X_{tr}\)</span> its closest sample found in <span class="math inline">\(X\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X = the input matrix</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># k = number of calibration samples to be selected</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pc = if pc is specified, k-mean is performed in the pc space </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (here we will use only the two 1st pcs)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># iter.max =  maximum number of iterations allowed for the k-means clustering.</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>kms <span class="ot">&lt;-</span> <span class="fu">naes</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">pc =</span> <span class="dv">2</span>, <span class="at">iter.max =</span> <span class="dv">100</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the pcs scores and clusters</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kms<span class="sc">$</span>pc, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;k-means&quot;</span>) </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the selected points</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(kms<span class="sc">$</span>pc[kms<span class="sc">$</span>model, ], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:naes"></span>
<img src="data:image/png;base64,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" alt="Selection of 5 samples by k-means sampling" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.1: Selection of 5 samples by k-means sampling
</p>
</div>
</div>
<div id="kennard-stone-sampling-kenstone" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Kennard-Stone sampling (<code>kenStone</code>)</h2>
<p>To sample a subset of <span class="math inline">\(n\)</span> samples
<span class="math inline">\(X_{tr} = \left \{ {x_{tr}}_{j} \right \}_{j=1}^{n}\)</span>, from a given set of <span class="math inline">\(N\)</span>
samples <span class="math inline">\(X = \left \{ x_i \right \}_{i=1}^{N}\)</span> (note that <span class="math inline">\(N&gt;n\)</span>) the
Kennard-Stone (CADEX) sampling algorithm consists in <span class="citation"><a href="#ref-kennard1969" role="doc-biblioref">Kennard and Stone</a> (<a href="#ref-kennard1969" role="doc-biblioref">1969</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Find in <span class="math inline">\(X\)</span> the samples <span class="math inline">\({x_{tr}}_1\)</span> and <span class="math inline">\({x_{tr}}_2\)</span> that are the farthest
apart from each other, allocate them in <span class="math inline">\(X_{tr}\)</span> and remove them from <span class="math inline">\(X\)</span>.</p></li>
<li><p>Find in <span class="math inline">\(X\)</span> the sample <span class="math inline">\({x_{tr}}_3\)</span> with the maximum dissimilarity to
<span class="math inline">\(X_{tr}\)</span>. Allocate <span class="math inline">\({x_{tr}}_3\)</span> in <span class="math inline">\(X_{tr}\)</span> and then remove it from <span class="math inline">\(X\)</span>.
The dissimilarity between <span class="math inline">\(X_{tr}\)</span> and each <span class="math inline">\(x_i\)</span> is given by the minimum
distance of any sample allocated in <span class="math inline">\(X_{tr}\)</span> to each <span class="math inline">\(x_i\)</span>. In other words,
the selected sample is one of the nearest neighbours of the points already
selected which is characterized by the maximum distance to the other points
already selected.</p></li>
<li><p>Repeat the step 2 n-3 times in order to select the remaining samples
(<span class="math inline">\({x_{tr}}_4,..., {x_{tr}}_n\)</span>).</p></li>
</ol>
<p>The Kennard-Stone algorithm allows to create a calibration set that has a flat
distribution over the spectral space. The metric used to compute the distance
between points can be either the Euclidean distance or the Mahalanobis distance.
One of the drawbacks of this algorithm is that it is prone to outlier selection
<span class="citation">(<a href="#ref-ramirez2014" role="doc-biblioref">Ramirez-Lopez et al. 2014</a>)</span>, therefore outlier analysis is recommended before sample
selection.</p>
<p>Let’s see some examples…</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset for illustrating how the calibration sampling </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># algorithms work</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;Kennard-Stone (synthetic)&quot;</span>) </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># kenStone produces a list with row index of the points selected for calibration</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ken <span class="ot">&lt;-</span> <span class="fu">kenStone</span>(X, <span class="at">k =</span> <span class="dv">40</span>) </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot selected points</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X[ken<span class="sc">$</span>model,], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.4</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ken"></span>
<img src="data:image/png;base64,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" alt="Selection of 40 calibration samples with the Kennard-Stone algorithm" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.2: Selection of 40 calibration samples with the Kennard-Stone algorithm
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test with the NIRsoil dataset</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># one can also use the mahalanobis distance (metric argument)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># computed in the pc space (pc argument)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ken_mahal <span class="ot">&lt;-</span> <span class="fu">kenStone</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">k =</span> <span class="dv">20</span>, <span class="at">metric =</span> <span class="st">&quot;mahal&quot;</span>, <span class="at">pc=</span> <span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The pc components in the output list stores the pc scores</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ken_mahal<span class="sc">$</span>pc[,<span class="dv">1</span>], </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>     ken_mahal<span class="sc">$</span>pc[,<span class="dv">2</span>], </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Kennard-Stone&quot;</span>) </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the selected points in the pc space</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ken_mahal<span class="sc">$</span>pc[ken_mahal<span class="sc">$</span>model, <span class="dv">1</span>], </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>       ken_mahal<span class="sc">$</span>pc[ken_mahal<span class="sc">$</span>model,<span class="dv">2</span>], </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ken2"></span>
<img src="data:image/png;base64,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" alt="Kennard-Stone sampling on the NIRsoil dataset" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.3: Kennard-Stone sampling on the NIRsoil dataset
</p>
</div>
</div>
<div id="duplex-duplex" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> DUPLEX (<code>duplex</code>)</h2>
<p>The Kennard-Stone algorithm selects <em>calibration</em> samples. Often, we need also
to select a <em>validation</em> subset. The DUPLEX algorithm <span class="citation">(<a href="#ref-snee1977" role="doc-biblioref">Snee 1977</a>)</span> is a
modification of the Kennard-Stone which allows to select a <em>validation</em> set
that have similar properties to the <em>calibration</em> set. DUPLEX, similarly to
Kennard-Stone, begins by selecting pairs of points that are the farthest
apart from each other, and then assigns points alternatively to the
<em>calibration</em> and <em>validation</em> sets.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dup <span class="ot">&lt;-</span> <span class="fu">duplex</span>(<span class="at">X =</span> X, <span class="at">k =</span> <span class="dv">15</span>) <span class="co"># k is the number of selected samples</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;DUPLEX&quot;</span>) </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calibration samples</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X[dup<span class="sc">$</span>model, <span class="dv">1</span>], X[dup<span class="sc">$</span>model, <span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>) </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># validation samples</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X[dup<span class="sc">$</span>test,<span class="dv">1</span>], X[dup<span class="sc">$</span>test,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>) </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;calibration&quot;</span>, <span class="st">&quot;validation&quot;</span>), </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:duplex"></span>
<img src="data:image/png;base64,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" alt="Selection of 15 calibration and validation samples with the DUPLEX algorithm" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.4: Selection of 15 calibration and validation samples with the DUPLEX algorithm
</p>
</div>
</div>
<div id="select-algorithm-shenkwest" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> SELECT algorithm (<code>shenkWest</code>)</h2>
<p>The SELECT algorithm <span class="citation">(<a href="#ref-shenk1991" role="doc-biblioref">Shenk and Westerhaus 1991</a>)</span> is an iterative procedure which selects the
sample having the maximum number of neighbour samples within a given distance
(<code>d.min</code> argument) and remove the neighbour samples of the selected sample
from the list of points. The number of selected samples depends on the chosen
treshold (default = 0.6). The distance metric is the Mahalanobis distance
divided by the number of dimensions (number of pc components) used to compute
the distance. Here is an example of how the <code>shenkWest</code> function might work:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>shenk <span class="ot">&lt;-</span> <span class="fu">shenkWest</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">d.min =</span> <span class="fl">0.6</span>, <span class="at">pc =</span> <span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shenk<span class="sc">$</span>pc, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;SELECT&quot;</span>) </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(shenk<span class="sc">$</span>pc[shenk<span class="sc">$</span>model,], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:shenk"></span>
<img src="data:image/png;base64,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" alt="Selection of samples with the SELECT algorithm" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.5: Selection of samples with the SELECT algorithm
</p>
</div>
</div>
<div id="puchwein-algorithm-puchwein" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Puchwein algorithm (<code>puchwein</code>)</h2>
<p>The Puchwein algorithm is yet another algorithm for calibration sampling
<span class="citation">(<a href="#ref-puchwein1988" role="doc-biblioref">Puchwein 1988</a>)</span> that create a calibration set with a flat distribution. A
nice feature of the algorithm is that it allows an objective selection of
the number of required calibration samples with the help of plots. First
the data is usually reduced through PCA and the most significant PCs are
retained. Then the mahalanobis distance (<span class="math inline">\(H\)</span>) to the center of the matrix
is computed and samples are sorted decreasingly. The distances betwwen
samples in the PC space are then computed.</p>
<p>Here are the steps followed by the algorithm:</p>
<ul>
<li><p>Step 1. Define a limiting distance.</p></li>
<li><p>Step 2. Find the sample with` <span class="math inline">\(\max(H)\)</span>.</p></li>
<li><p>Step 3. Remove all the samples which are within the limiting distance away
from the sample selected in step 2.</p></li>
<li><p>Step 4. Go back in step 2 and find the sample with <span class="math inline">\(\max(H)\)</span> within the
remaining samples.</p></li>
<li><p>Step 5. When there is no sample anymore, go back to step 1 and increase
the limiting distance.</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pu <span class="ot">&lt;-</span> <span class="fu">puchwein</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">k =</span> <span class="fl">0.2</span>, <span class="at">pc =</span><span class="dv">2</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pu<span class="sc">$</span>pc, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;puchwein&quot;</span>) </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(pu<span class="sc">$</span>pc[pu<span class="sc">$</span>model,],<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>) <span class="co"># selected samples</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:puchwein"></span>
<img src="data:image/png;base64,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" alt="Samples selected by the Puchwein algorithm" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.6: Samples selected by the Puchwein algorithm
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pu<span class="sc">$</span>leverage<span class="sc">$</span>removed,pu<span class="sc">$</span>leverage<span class="sc">$</span>diff, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;# samples removed&quot;</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Difference between th. and obs sum of leverages&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This basically shows that the first loop is optimal</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pu<span class="sc">$</span>leverage<span class="sc">$</span>loop,<span class="fu">nrow</span>(NIRsoil) <span class="sc">-</span> pu<span class="sc">$</span>leverage<span class="sc">$</span>removed,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;# loops&quot;</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;# samples kept&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="honigs-honigs" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Honigs (<code>honigs</code>)</h2>
<p>The Honigs algorithm selects samples based on the size of their absorption
features <span class="citation">(<a href="#ref-honigs1985" role="doc-biblioref">Honigs et al. 1985</a>)</span>. It can works both on absorbance and continuum-removed
spectra. The sample having the highest absorption feature is selected first.
Then this absorption is substracted from other spectra and the algorithm
iteratively select samples with the highest absorption (in absolute value)
until the desired number of samples is reached.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># type = &quot;A&quot; is for absorbance data</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ho <span class="ot">&lt;-</span> <span class="fu">honigs</span>(<span class="at">X =</span> NIRsoil<span class="sc">$</span>spc, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;A&quot;</span>) </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot calibration spectra</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc)),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">t</span>(NIRsoil<span class="sc">$</span>spc[ho<span class="sc">$</span>model,]),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Wavelength&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add bands used during the selection process</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(NIRsoil<span class="sc">$</span>spc))[ho<span class="sc">$</span>bands], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:honigs"></span>
<img src="data:image/png;base64,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" alt="Spectra selected with the Honigs algorithm and bands used" style="background-color: #FFFFFF; border: 10px solid transparent; padding:0px" />
<p class="caption">
Figure 7.7: Spectra selected with the Honigs algorithm and bands used
</p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-barnes1989" class="csl-entry">
Barnes, RJ, Mewa Singh Dhanoa, and Susan J Lister. 1989. <span>“Standard Normal Variate Transformation and de-Trending of Near-Infrared Diffuse Reflectance Spectra.”</span> In <em>Applied Spectroscopy</em>, 43:772–77. 5. SAGE Publications Sage UK: London, England.
</div>
<div id="ref-clark1984" class="csl-entry">
Clark, Roger N, and Ted L Roush. 1984. <span>“Reflectance Spectroscopy: Quantitative Analysis Techniques for Remote Sensing Applications.”</span> In <em>Journal of Geophysical Research: Solid Earth</em>, 89:6329–40. B7. Wiley Online Library.
</div>
<div id="ref-eriksson2006" class="csl-entry">
Eriksson, Lennart, Erik Johansson, N Kettaneh-Wold, Johan Trygg, C Wikström, and Svante Wold. 2006. <em>Multi-and Megavariate Data Analysis</em>. Vol. 1. Umetrics Sweden.
</div>
<div id="ref-fearn2008" class="csl-entry">
Fearn, Tom. 2008. <span>“The Interaction Between Standard Normal Variate and Derivatives.”</span> <em>NIR News</em> 19 (7): 16–17.
</div>
<div id="ref-fearn2010" class="csl-entry">
———. 2010. <span>“Combining Other Predictors with NIR Spectra.”</span> <em>NIR News</em> 21 (2): 13–16.
</div>
<div id="ref-fernandez2008" class="csl-entry">
Fernandez-Pierna, Juan Antonio, and Pierre Dardenne. 2008. <span>“Soil Parameter Quantification by NIRS as a Chemometric Challenge at <span>‘Chimiom<span>é</span>trie 2006’</span>.”</span> <em>Chemometrics and Intelligent Laboratory Systems</em> 91 (1): 94–98.
</div>
<div id="ref-geladi1985linearization" class="csl-entry">
Geladi, P, D MacDougall, and H Martens. 1985. <span>“Linearization and Scatter-Correction for Near-Infrared Reflectance Spectra of Meat.”</span> <em>Applied Spectroscopy</em> 39 (3): 491–500.
</div>
<div id="ref-honigs1985" class="csl-entry">
Honigs, DE, Gary M Hieftje, HL Mark, and TB Hirschfeld. 1985. <span>“Unique-Sample Selection via Near-Infrared Spectral Subtraction.”</span> <em>Analytical Chemistry</em> 57 (12): 2299–2303.
</div>
<div id="ref-kennard1969" class="csl-entry">
Kennard, Ronald W, and Larry A Stone. 1969. <span>“Computer Aided Design of Experiments.”</span> <em>Technometrics</em> 11 (1): 137–48.
</div>
<div id="ref-mullen2007" class="csl-entry">
Mullen, Katharine M, and Ivo HM van Stokkum. 2007. <span>“An Introduction to the’special Volume Spectroscopy and Chemometrics in r’.”</span> <em>Journal of Statistical Software</em> 18 (01).
</div>
<div id="ref-naes2002" class="csl-entry">
Naes, T, T Isaksson, T Fearn, and T Davies. 2002. <span>“Outlier Detection. A User-Friendly Guide to Multivariate Calibration and Classification.”</span> NIR Publications, Chichester.
</div>
<div id="ref-puchwein1988" class="csl-entry">
Puchwein, Gerd. 1988. <span>“Selection of Calibration Samples for Near-Infrared Spectrometry by Factor Analysis of Spectra.”</span> <em>Analytical Chemistry</em> 60 (6): 569–73.
</div>
<div id="ref-ramirez2014" class="csl-entry">
Ramirez-Lopez, Leonardo, Karsten Schmidt, Thorsten Behrens, Bas Van Wesemael, Jose AM Demattê, and Thomas Scholten. 2014. <span>“Sampling Optimal Calibration Sets in Soil Infrared Spectroscopy.”</span> <em>Geoderma</em> 226: 140–50.
</div>
<div id="ref-rinnan2009review" class="csl-entry">
Rinnan, Åsmund, Frans Van Den Berg, and Søren Balling Engelsen. 2009. <span>“Review of the Most Common Pre-Processing Techniques for Near-Infrared Spectra.”</span> <em>TrAC Trends in Analytical Chemistry</em> 28 (10): 1201–22.
</div>
<div id="ref-savitzky1964" class="csl-entry">
Savitzky, Abraham, and Marcel JE Golay. 1964. <span>“Smoothing and Differentiation of Data by Simplified Least Squares Procedures.”</span> <em>Analytical Chemistry</em> 36 (8): 1627–39.
</div>
<div id="ref-shenk1991" class="csl-entry">
Shenk, JS, and MO Westerhaus. 1991. <span>“Population Definition, Sample Selection, and Calibration Procedures for Near Infrared Reflectance Spectroscopy.”</span> <em>Crop Science</em> 31 (2): 469–74.
</div>
<div id="ref-snee1977" class="csl-entry">
Snee, Ronald D. 1977. <span>“Validation of Regression Models: Methods and Examples.”</span> <em>Technometrics</em> 19 (4): 415–28.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
